(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=e(o);fetch(o.href,r)}})();class l{constructor(){this.totalCoins=100580,this.totalStars=770,this.currentLevelStars=11855,this.targetLevelStars=29e3,this.clickPower=1,this.level=1,this.autoCollectorActive=!0,this.autoCollectorTimeLeft=600,this.boosterMultiplier=1,this.boosterTimeLeft=0,this.lastUpdate=Date.now(),this.autoCollectRate=10}init(){this.updateUI(),this.startAutoCollector()}startGameLoop(){setInterval(()=>{this.gameLoop()},1e3)}gameLoop(){const t=Date.now(),e=(t-this.lastUpdate)/1e3;if(this.lastUpdate=t,this.autoCollectorActive&&this.autoCollectorTimeLeft>0){this.autoCollectorTimeLeft-=e;const s=Math.floor(this.autoCollectRate*e);this.totalCoins+=s,this.autoCollectorTimeLeft<=0&&(this.autoCollectorActive=!1,this.autoCollectorTimeLeft=0)}this.boosterTimeLeft>0&&(this.boosterTimeLeft-=e,this.boosterTimeLeft<=0&&(this.boosterMultiplier=1)),this.updateUI()}collectReward(t,e){const s=Math.floor(t*this.boosterMultiplier);this.totalCoins+=s,this.currentLevelStars+=Math.floor(s/10),this.currentLevelStars>=this.targetLevelStars&&this.levelUp(),this.showFloatingText(`+${s}`,e),this.animateReward(e),this.updateUI()}clickCharacter(t){const e=this.clickPower*this.boosterMultiplier;this.totalCoins+=e,this.currentLevelStars+=Math.floor(e/10),t.style.transform="scale(0.95)",setTimeout(()=>{t.style.transform="scale(1)"},100),this.showFloatingText(`+${e}`,t),this.updateUI()}activateBooster(){this.boosterMultiplier=2,this.boosterTimeLeft=30,document.querySelector(".boosters-btn").style.background="#ff6b35",setTimeout(()=>{document.querySelector(".boosters-btn").style.background=""},200)}activateBoosterStar(t){document.querySelectorAll(".booster-star").forEach(e=>{e.classList.remove("active")}),document.querySelectorAll(".booster-star")[t].classList.add("active"),this.clickPower=t+1}levelUp(){this.level++,this.totalStars+=10,this.currentLevelStars=0,this.targetLevelStars=Math.floor(this.targetLevelStars*1.5),this.showLevelUpAnimation(),window.telegramApp&&(window.telegramApp.telegram.hapticFeedback("success"),window.telegramApp.telegram.showAlert(`🎉 Level Up! You reached level ${this.level}!`))}showFloatingText(t,e){const s=document.createElement("div");s.className="floating-text",s.textContent=t;const o=e.getBoundingClientRect();s.style.left=o.left+o.width/2+"px",s.style.top=o.top+"px",document.body.appendChild(s),setTimeout(()=>{s.remove()},1e3)}animateReward(t){t.style.transform="scale(1.1)",t.style.filter="brightness(1.3)",setTimeout(()=>{t.style.transform="scale(1)",t.style.filter="brightness(1)"},200)}showLevelUpAnimation(){const t=document.createElement("div");t.className="level-up-animation",t.innerHTML=`
      <div class="level-up-text">LEVEL UP!</div>
      <div class="level-up-number">Level ${this.level}</div>
    `,document.body.appendChild(t),setTimeout(()=>{t.remove()},2e3)}startAutoCollector(){this.autoCollectorActive&&setInterval(()=>{this.autoCollectorActive&&this.autoCollectorTimeLeft>0&&this.updateAutoCollectorUI()},1e3)}updateAutoCollectorUI(){const t=(600-this.autoCollectorTimeLeft)/600*100,e=document.querySelector(".mini-progress-fill");e&&(e.style.width=t+"%");const s=Math.floor(this.autoCollectorTimeLeft),o=Math.floor(s/60),r=s%60,i=document.querySelector(".collector-text");i&&(i.textContent=`Auto-collector stars for ${o}:${r.toString().padStart(2,"0")}`)}updateBoosterStartUI(){const t=(600-this.autoCollectorTimeLeft)/600*100,e=document.querySelector(".mini-progress-fill");e&&(e.style.width=t+"%");const s=Math.floor(this.autoCollectorTimeLeft),o=Math.floor(s/60),r=s%60,i=document.querySelector("div#booster_collector_countdown>.collector-text");i&&(i.textContent=`Booster stars for ${o}:${r.toString().padStart(2,"0")}`)}updateUI(){document.getElementById("totalCoins").textContent=this.totalCoins.toLocaleString(),document.getElementById("totalStars").textContent=this.totalStars,document.getElementById("currentLevelStars").textContent=this.currentLevelStars.toLocaleString();const t=Math.floor(this.currentLevelStars/this.targetLevelStars*100);if(document.getElementById("progressPercent").textContent=t+"%",document.getElementById("progressFill").style.width=t+"%",this.autoCollectorActive){const e=Math.floor((600-this.autoCollectorTimeLeft)/600*100);document.querySelector(".progress-text").textContent=e+"%"}}getStats(){return{totalCoins:this.totalCoins,totalStars:this.totalStars,level:this.level,clickPower:this.clickPower,currentLevelStars:this.currentLevelStars,targetLevelStars:this.targetLevelStars,autoCollectorActive:this.autoCollectorActive,boosterMultiplier:this.boosterMultiplier}}}class n{constructor(){var t;this.tg=(t=window.Telegram)==null?void 0:t.WebApp,this.isInTelegram=!!this.tg,this.botToken="8302115146:AAFJpm5wP2Jcn6RcDZxNdVdJaO1hxWYsSGw",this.userData=null,this.initData=null}async init(){var t;this.isInTelegram?(console.log("🚀 Initializing Telegram Mini App..."),this.initData=this.tg.initData,this.userData=(t=this.tg.initDataUnsafe)==null?void 0:t.user,console.log("📱 Telegram WebApp Info:"),console.log("- Version:",this.tg.version),console.log("- Platform:",this.tg.platform),console.log("- User:",this.userData),console.log("- InitData available:",!!this.initData),this.tg.ready(),this.configureApp(),this.applyTelegramTheme(),this.setupMainButton(),this.setupBackButton(),this.tg.enableClosingConfirmation(),console.log("✅ Telegram Mini App initialized successfully!")):(console.log("⚠️ Not running in Telegram - Demo mode"),this.setupDemoMode())}configureApp(){this.tg.expand(),this.tg.setHeaderColor("#FFF4E6"),this.tg.setBackgroundColor("#FFF4E6"),this.tg.BackButton.hide()}applyTelegramTheme(){const t=document.documentElement,e=this.tg.themeParams;console.log("🎨 Applying Telegram theme:",e),e.bg_color&&(t.style.setProperty("--tg-bg-color",e.bg_color),t.style.setProperty("--background-cream",e.bg_color)),e.text_color&&(t.style.setProperty("--tg-text-color",e.text_color),t.style.setProperty("--text-brown",e.text_color)),e.button_color&&(t.style.setProperty("--tg-button-color",e.button_color),t.style.setProperty("--secondary-orange",e.button_color)),e.button_text_color&&t.style.setProperty("--tg-button-text-color",e.button_text_color),e.secondary_bg_color&&t.style.setProperty("--reward-blue",e.secondary_bg_color)}setupMainButton(){this.isInTelegram&&(this.tg.MainButton.setText("🌟 Share Progress"),this.tg.MainButton.color="#FF8C42",this.tg.MainButton.textColor="#FFFFFF",this.tg.MainButton.onClick(()=>{this.shareProgress()}),this.tg.MainButton.show())}setupBackButton(){this.isInTelegram&&this.tg.BackButton.onClick(()=>{this.showAlert("Back button pressed!")})}displayUserInfo(){if(!this.userData)return;const t=document.getElementById("init-data-value");t&&(t.innerHTML=`
        <div style="background: rgba(255,255,255,0.9); padding: 8px; border-radius: 8px; margin: 8px 0; font-size: 12px;">
          <div><strong>👤 ${this.userData.first_name||"User"}</strong></div>
          <div>🆔 ID: ${this.userData.id}</div>
          ${this.userData.username?`<div>📱 @${this.userData.username}</div>`:""}
          <div>🌐 Lang: ${this.userData.language_code||"en"}</div>
        </div>
      `)}setupDemoMode(){console.log("🔧 Setting up demo mode..."),this.userData={id:123456789,first_name:"Demo User",username:"demo_user",language_code:"en"},this.displayUserInfo(),setTimeout(()=>{alert("🔧 Demo Mode: This is how the app works in Telegram!")},1e3)}shareProgress(t=null){var r;const e=t||{totalCoins:100580,totalStars:770,level:1,progressPercent:41},o=`🌟 ${((r=this.userData)==null?void 0:r.first_name)||"Player"} is collecting stars!

💰 Coins: ${e.totalCoins.toLocaleString()}
⭐ Stars: ${e.totalStars}
🎯 Level: ${e.level}
📊 Progress: ${e.progressPercent}%

🚀 Join the Star Collector game!`;this.isInTelegram?(this.tg.shareToStory?this.tg.shareToStory(window.location.href,{text:o,widget_link:{url:window.location.href,name:"Star Collector"}}):this.tg.switchInlineQuery?this.tg.switchInlineQuery(o,["users","groups"]):(this.copyToClipboard(o+`

`+window.location.href),this.showAlert(`📋 Progress copied to clipboard!
Share it in any chat.`)),this.hapticFeedback("success")):(this.copyToClipboard(o+`

`+window.location.href),alert("📋 Progress copied to clipboard!"))}copyToClipboard(t){if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(t);{const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();try{return document.execCommand("copy"),e.remove(),Promise.resolve()}catch(s){return e.remove(),Promise.reject(s)}}}showAlert(t){this.isInTelegram?this.tg.showAlert(t):alert(t)}showConfirm(t,e){if(this.isInTelegram)this.tg.showConfirm(t,e);else{const s=confirm(t);e(s)}}showPopup(t){if(this.isInTelegram&&this.tg.showPopup)this.tg.showPopup(t);else{const e=t.message||t.title||"Notification";alert(e)}}hapticFeedback(t="medium"){if(this.isInTelegram&&this.tg.HapticFeedback)try{switch(t){case"light":this.tg.HapticFeedback.impactOccurred("light");break;case"medium":this.tg.HapticFeedback.impactOccurred("medium");break;case"heavy":this.tg.HapticFeedback.impactOccurred("heavy");break;case"success":this.tg.HapticFeedback.notificationOccurred("success");break;case"error":this.tg.HapticFeedback.notificationOccurred("error");break;case"warning":this.tg.HapticFeedback.notificationOccurred("warning");break;default:this.tg.HapticFeedback.impactOccurred("medium")}}catch(e){console.log("Haptic feedback not available:",e)}}getUserData(){return this.userData}getInitData(){var t,e;return{initData:this.initData,user:this.userData,platform:(t=this.tg)==null?void 0:t.platform,version:(e=this.tg)==null?void 0:e.version}}sendData(t){if(this.isInTelegram)try{this.tg.sendData(JSON.stringify(t))}catch(e){console.error("Error sending data:",e)}}setScore(t){var e;this.sendData({action:"set_score",score:t,user_id:(e=this.userData)==null?void 0:e.id,timestamp:Date.now()})}openLink(t,e={}){this.isInTelegram?this.tg.openLink(t,e):window.open(t,"_blank")}openTelegramLink(t){this.isInTelegram?this.tg.openTelegramLink(t):window.open(t,"_blank")}requestWriteAccess(t){this.isInTelegram&&this.tg.requestWriteAccess?this.tg.requestWriteAccess(t):t&&t(!1)}requestContact(t){this.isInTelegram&&this.tg.requestContact?this.tg.requestContact(t):t&&t(!1)}cloudStorageSetItem(t,e,s){if(this.isInTelegram&&this.tg.CloudStorage&&this.isCloudStorageSupported())this.tg.CloudStorage.setItem(t,e,s);else try{localStorage.setItem(`tg_${t}`,e),s&&s(null,!0)}catch(o){s&&s(o,!1)}}cloudStorageGetItem(t,e){if(this.isInTelegram&&this.tg.CloudStorage&&this.isCloudStorageSupported())this.tg.CloudStorage.getItem(t,e);else try{const s=localStorage.getItem(`tg_${t}`);e&&e(null,s)}catch(s){e&&e(s,null)}}cloudStorageRemoveItem(t,e){if(this.isInTelegram&&this.tg.CloudStorage&&this.isCloudStorageSupported())this.tg.CloudStorage.removeItem(t,e);else try{localStorage.removeItem(`tg_${t}`),e&&e(null,!0)}catch(s){e&&e(s,!1)}}isCloudStorageSupported(){return!this.tg||!this.tg.version?!1:parseFloat(this.tg.version)>=6.1}saveGameProgress(t){var s;const e={...t,user_id:(s=this.userData)==null?void 0:s.id,timestamp:Date.now()};this.cloudStorageSetItem("game_progress",JSON.stringify(e),(o,r)=>{o?console.error("Failed to save game progress:",o):console.log("✅ Game progress saved to cloud")})}loadGameProgress(t){this.cloudStorageGetItem("game_progress",(e,s)=>{if(e)console.error("Failed to load game progress:",e),t&&t(null);else try{const o=s?JSON.parse(s):null;console.log("📥 Game progress loaded from cloud:",o),t&&t(o)}catch(o){console.error("Failed to parse game progress:",o),t&&t(null)}})}isRunningInTelegram(){return this.isInTelegram}getAppInfo(){var t,e,s;return{isInTelegram:this.isInTelegram,version:(t=this.tg)==null?void 0:t.version,platform:(e=this.tg)==null?void 0:e.platform,user:this.userData,themeParams:(s=this.tg)==null?void 0:s.themeParams}}}class c{constructor(){this.game=new l,this.telegram=new n,this.isInitialized=!1,this.init()}async init(){console.log("🚀 Starting Star Collector Mini App..."),await this.telegram.init(),await this.loadGameProgress(),this.game.init(),this.setupEventListeners(),this.game.startGameLoop(),this.startAutoSave(),this.isInitialized=!0,console.log("✅ App initialized successfully!")}async loadGameProgress(){return new Promise(t=>{this.telegram.loadGameProgress(e=>{var s;e&&e.user_id===((s=this.telegram.getUserData())==null?void 0:s.id)?(console.log("📥 Restoring saved game progress..."),this.game.totalCoins=e.totalCoins||this.game.totalCoins,this.game.totalStars=e.totalStars||this.game.totalStars,this.game.currentLevelStars=e.currentLevelStars||this.game.currentLevelStars,this.game.level=e.level||this.game.level,this.game.clickPower=e.clickPower||this.game.clickPower,console.log("✅ Game progress restored!"),this.telegram.showAlert("🎮 Welcome back! Your progress has been restored.")):console.log("🆕 Starting new game..."),t()})})}saveGameProgress(){if(!this.isInitialized)return;const t={totalCoins:this.game.totalCoins,totalStars:this.game.totalStars,currentLevelStars:this.game.currentLevelStars,level:this.game.level,clickPower:this.game.clickPower,targetLevelStars:this.game.targetLevelStars};this.telegram.saveGameProgress(t)}startAutoSave(){setInterval(()=>{this.saveGameProgress()},3e4),window.addEventListener("beforeunload",()=>{this.saveGameProgress()})}setupEventListeners(){document.querySelectorAll(".reward-item, .special-reward").forEach(s=>{s.addEventListener("click",o=>{const r=parseInt(o.currentTarget.dataset.value);this.game.collectReward(r,o.currentTarget),this.telegram.hapticFeedback("light"),this.saveGameProgress()})});const t=document.getElementById("boostersToggleBtn"),e=document.getElementById("boosterCountdown");e.style.display="none",t.addEventListener("click",()=>{t.style.display="none",e.style.display="block",console.log("🚀 Booster started!")}),document.querySelectorAll(".nav-item").forEach(s=>{s.addEventListener("click",o=>{this.handleNavigation(o.currentTarget.dataset.tab),this.telegram.hapticFeedback("light")})}),document.querySelectorAll(".booster-star").forEach((s,o)=>{s.addEventListener("click",()=>{this.game.activateBoosterStar(o),this.telegram.hapticFeedback("success"),this.telegram.showAlert(`⭐ Click power set to ${o+1}!`)})})}handleNavigation(t){switch(document.querySelectorAll(".nav-item").forEach(e=>{e.classList.remove("active")}),document.querySelector(`[data-tab="${t}"]`).classList.add("active"),t){case"earn":break;case"tasks":this.showTasksMenu();break;case"upgrade":this.showUpgradeMenu();break;case"profile":this.showProfile();break}}showTasksMenu(){const e=`📋 Daily Tasks:

`+["📱 Share the game with 3 friends","⭐ Collect 1000 stars","💰 Earn 50,000 coins","🎯 Reach level 5","🚀 Use booster 10 times"].map((s,o)=>`${o+1}. ${s}`).join(`
`);this.telegram.showAlert(e)}showUpgradeMenu(){const e=`💼 Available Upgrades:

`+["⚡ Click Power +1 (Cost: 10,000 coins)","🤖 Auto Collector Speed +50% (Cost: 25,000 coins)","🌟 Star Multiplier x2 (Cost: 50,000 coins)","💎 Premium Rewards (Cost: 100,000 coins)"].join(`

`)+`

💰 Your coins: `+this.game.totalCoins.toLocaleString();this.telegram.showAlert(e)}showProfile(){const t=this.telegram.getUserData(),e=this.game.getStats(),s=this.telegram.getAppInfo(),o=`👤 Profile

💰 Total Coins: ${e.totalCoins.toLocaleString()}
⭐ Total Stars: ${e.totalStars}
🎯 Level: ${e.level}
⚡ Click Power: ${e.clickPower}

`+(t?`👋 Hello ${t.first_name}!
`:`👋 Welcome!
`)+(t!=null&&t.username?`📱 @${t.username}
`:"")+`🌐 Language: ${(t==null?void 0:t.language_code)||"en"}
📱 Platform: ${s.platform||"web"}
🔧 Version: ${s.version||"unknown"}`;this.telegram.showAlert(o),this.updateShareButton()}updateShareButton(){const t=this.game.getStats(),e=Math.floor(this.game.currentLevelStars/this.game.targetLevelStars*100);this.telegram.shareProgress=()=>{this.telegram.shareProgress({totalCoins:t.totalCoins,totalStars:t.totalStars,level:t.level,progressPercent:e})}}}new c;
